<div class="min-h-screen bg-gradient-to-br from-orange-50 via-white to-green-50 py-10 px-4 flex justify-center">
  <div class="max-w-3xl w-full bg-white rounded-2xl shadow-lg border-t-4 border-orange-500 p-6">

    <!-- Titre principal -->
    <h2
      class="text-3xl font-bold mb-6 text-center bg-gradient-to-r from-orange-500 via-white to-green-500 bg-clip-text text-transparent uppercase">
      Cr√©er une nouvelle annonce
    </h2>

    <form [formGroup]="form" (ngSubmit)="submit()" class="space-y-6">

      <!-- Titre -->
      <div>
        <label class="block font-semibold mb-1 text-gray-700">Titre</label>
        <input
          formControlName="title"
          type="text"
          class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-orange-50/20"
        />
      </div>

      <!-- Description -->
      <div>
        <label class="block font-semibold mb-1 text-gray-700">Description</label>
        <textarea
          formControlName="description"
          rows="4"
          class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-green-50/20"
        ></textarea>
      </div>

      <!-- Prix et n√©gociable -->
      <div class="flex flex-col sm:flex-row gap-4">
        <div class="flex-1">
          <label class="block font-semibold mb-1 text-gray-700">Prix (FCFA)</label>
          <input
            formControlName="price"
            type="number"
            class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-orange-50/20"
          />
        </div>
        <div class="flex items-center mt-1 sm:mt-7">
          <input formControlName="is_negotiable" type="checkbox" id="negotiable" class="mr-2 accent-green-500" />
          <label for="negotiable" class="font-medium text-gray-700">N√©gociable</label>
        </div>
      </div>

      <!-- Cat√©gorie et ville -->
      <div class="flex flex-col sm:flex-row gap-4">
        <div class="flex-1">
          <label class="block font-semibold mb-1 text-gray-700">Cat√©gorie</label>
          <select
            formControlName="category"
            class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-green-50/20"
          >
            <option value="">-- S√©lectionner --</option>
            <option *ngFor="let cat of categories" [value]="cat.value">{{ cat.label }}</option>
          </select>
        </div>
        <div class="flex-1">
          <label class="block font-semibold mb-1 text-gray-700">Ville</label>
          <select
            formControlName="city"
            class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-orange-50/20"
          >
            <option value="">-- S√©lectionner --</option>
            <option *ngFor="let c of cities" [value]="c.value">{{ c.label }}</option>
          </select>
        </div>
      </div>

      <!-- Date d'expiration -->
      <div>
        <label class="block font-semibold mb-1 text-gray-700">Date d'expiration</label>
        <input
          formControlName="expires_at"
          type="date"
          [min]="today()"
          class="w-full border rounded-lg p-3 focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white text-amber-950"
        />
      </div>

      <!-- Images -->
      <div>
        <label class="block font-semibold mb-2 text-gray-700">Images (max 3)</label>

        <!-- Boutons -->
        <div class="flex flex-wrap gap-3 mb-3">
          <!-- Galerie -->
          <label
            class="cursor-pointer bg-orange-500 hover:bg-orange-600 text-white font-medium py-2 px-4 rounded-lg shadow transition"
            [class.opacity-50]="selectedImages.length >= 3"
          >
            üìÅ Choisir depuis la galerie
            <input
              type="file"
              accept="image/*"
              (change)="onImagesSelected($event)"
              [disabled]="selectedImages.length >= 3"
              class="hidden"
            />
          </label>

          <!-- Cam√©ra -->
          <label
            class="cursor-pointer bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg shadow transition"
            [class.opacity-50]="selectedImages.length >= 3"
          >
            üì∏ Prendre une photo
            <input
              type="file"
              accept="image/*"
              capture="environment"
              (change)="onImagesSelected($event)"
              [disabled]="selectedImages.length >= 3"
              class="hidden"
            />
          </label>
        </div>

        <!-- Message si limite atteinte -->
        <p *ngIf="selectedImages.length >= 3" class="text-red-600 font-medium text-sm">
          ‚ö†Ô∏è Vous pouvez ajouter au maximum 3 images.
        </p>

        <!-- Aper√ßu -->
        <div class="flex flex-wrap gap-3 mt-3">
          <div
            *ngFor="let img of imagePreviews; let i = index"
            class="relative group"
          >
            <img
              [src]="img"
              class="w-24 h-24 object-cover rounded-lg border-4 border-green-400 shadow-sm"
             alt="picture"/>
            <button
              type="button"
              (click)="removeImage(i)"
              class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition"
            >
              ‚úï
            </button>
          </div>
        </div>
      </div>

      <!-- Submit -->
      <div class="text-center pt-4">
        <button
          type="submit"
          [disabled]="loading"
          class="w-full md:w-auto bg-gradient-to-r from-orange-500 to-green-500 text-black font-semibold rounded-full py-3 px-8 shadow-lg hover:shadow-xl transition-transform transform hover:-translate-y-0.5"
        >
          {{ loading ? 'Enregistrement...' : 'Publier l\'annonce' }}
        </button>
      </div>
    </form>
  </div>
</div>
